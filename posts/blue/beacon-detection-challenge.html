<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beacon Detection Challenge: Nh·∫≠t k√Ω SOC c·ªßa sinh vi√™n nƒÉm 3 - V≈© VƒÉn Th√¥ng</title>
    <meta name="description" content="Chia s·∫ª kinh nghi·ªám th·ª±c t·∫ø v·ªÅ vi·ªác ph√°t hi·ªán v√† x·ª≠ l√Ω C2 beacon trong lab SOC mini. H∆∞·ªõng d·∫´n chi ti·∫øt quy tr√¨nh IR t·ª´ g√≥c nh√¨n sinh vi√™n">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üë®‚Äçüíª</text></svg>">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="stylesheet" href="../../assets/css/blog.css">
</head>
<body>
    <!-- Sidebar Placeholder -->
    <div id="sidebar-placeholder"></div>
    
    <!-- Mobile Sidebar Toggle -->
    <button class="sidebar-toggle" id="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Header Placeholder -->
    <div id="header-placeholder"></div>

    <!-- Blog Post Content -->
    <article class="blog-post">
        <div class="container">
            <!-- Post Header -->
            <header class="post-header">
                <div class="post-breadcrumb">
                    <a href="../../blog.html"><i class="fas fa-arrow-left"></i> Quay l·∫°i Blog</a>
                </div>
                
                <div class="post-meta">
                    <span class="post-category">Blue Team</span>
                    <span class="post-date">
                        <i class="far fa-calendar"></i>
                        31 Th√°ng 10, 2025
                    </span>
                    <span class="post-read-time">
                        <i class="far fa-clock"></i>
                                18 ph√∫t ƒë·ªçc
                    </span>
                </div>
                
                <h1 class="post-title">üì° Beacon Detection Challenge: Nh·∫≠t k√Ω SOC c·ªßa sinh vi√™n nƒÉm 3</h1>
                <p class="post-subtitle">Chia s·∫ª kinh nghi·ªám th·ª±c t·∫ø v·ªÅ vi·ªác ph√°t hi·ªán v√† x·ª≠ l√Ω C2 beacon trong lab SOC mini</p>
                
                <div class="post-tags">
                    <span class="tag">SOC</span>
                    <span class="tag">Threat Hunting</span>
                    <span class="tag">C2 Detection</span>
                    <span class="tag">Network Security</span>
                </div>
            </header>

            <!-- Post Content -->
            <div class="post-content">
                <div class="post-excerpt">
                    <p>Ch√†o c√°c b·∫°n! M√¨nh l√† V≈© VƒÉn Th√¥ng, sinh vi√™n nƒÉm 3 ng√†nh An to√†n th√¥ng tin. H√¥m nay m√¨nh mu·ªën chia s·∫ª v·ªõi c√°c b·∫°n m·ªôt th·ª≠ th√°ch r·∫•t th√∫ v·ªã - m√¨nh ƒë√£ "b·∫Øt s·ªëng" m·ªôt C2 beacon √¢m th·∫ßm trong lab SOC mini m√† m√¨nh t·ª± d·ª±ng. ƒê√¢y l√† b√†i vi·∫øt m√¥ ph·ªèng 100% ph·ª•c v·ª• h·ªçc t·∫≠p, m·ªçi d·ªØ ki·ªán/IP/domain ƒë·ªÅu ƒë∆∞·ª£c ·∫©n/gi·∫£ ƒë·ªãnh.</p>
                </div>

                <div class="alert-box">
                    <h4>‚ö†Ô∏è L∆∞u √Ω quan tr·ªçng</h4>
                    <p>B√†i vi·∫øt n√†y l√† <strong>m√¥ ph·ªèng 100%</strong> ph·ª•c v·ª• h·ªçc t·∫≠p. M·ªçi d·ªØ ki·ªán, IP, domain ƒë·ªÅu ƒë∆∞·ª£c <strong>·∫©n/gi·∫£ ƒë·ªãnh</strong> theo chu·∫©n RFC 5737. M·ª•c ƒë√≠ch l√† chia s·∫ª ki·∫øn th·ª©c v√† kinh nghi·ªám h·ªçc t·∫≠p.</p>
                </div>

                <h2>B·ªëi c·∫£nh & m·ª•c ti√™u h·ªçc t·∫≠p</h2>
                
                <p>Khi m√¨nh h·ªçc v·ªÅ Threat Hunting v√† C2 Detection, m√¨nh lu√¥n th·∫Øc m·∫Øc: "L√†m sao ƒë·ªÉ ph√°t hi·ªán m·ªôt beacon C2 khi n√≥ ho·∫°t ƒë·ªông r·∫•t √¢m th·∫ßm?". ƒê·ªÉ tr·∫£ l·ªùi c√¢u h·ªèi n√†y, m√¨nh ƒë√£ d·ª±ng m·ªôt lab SOC mini v√† th·ª±c hi·ªán m·ªôt b√†i t·∫≠p m√¥ ph·ªèng C2 beacon.</p>

                <div class="lab-setup">
                    <h3>M√¥i tr∆∞·ªùng lab c·ªßa m√¨nh:</h3>
                    <ul>
                        <li><strong>Attacker</strong>: <code>ATTACKER-01</code> (VPS m√¥ ph·ªèng m√°y ƒëi·ªÅu khi·ªÉn C2)</li>
                        <li><strong>C2 server</strong>: <code>c2-edge.example.net</code> ‚Üí IP gi·∫£ l·∫≠p <code>203.0.113.77</code> (RFC 5737)</li>
                        <li><strong>Client (ng∆∞·ªùi d√πng)</strong>: <code>THONG-LAB-WIN02</code> (Windows 10), IP n·ªôi b·ªô <code>10.10.30.21</code></li>
                        <li><strong>Telemetries</strong>: EDR (process/DNS/HTTP/TLS), Proxy, NetFlow, Zeek</li>
                    </ul>
                </div>

                <div class="roles-setup">
                    <h3>Vai tr√≤ trong lab:</h3>
                    <ul>
                        <li><strong>M√¨nh (Th√¥ng)</strong>: SOC L1 (triage) + SOC L2 (investigation)</li>
                        <li><strong>Mentor</strong>: SOC L3 (ph√™ duy·ªát & quy·∫øt ƒë·ªãnh)</li>
                    </ul>
                </div>

                <div class="learning-goals">
                    <h3>M·ª•c ti√™u h·ªçc t·∫≠p:</h3>
                    <ol>
                        <li>Nh·∫≠n di·ªán beaconing: l∆∞u l∆∞·ª£ng nh·ªè, ƒë·ªãnh k·ª≥ + jitter, UA/JA3 b·∫•t th∆∞·ªùng</li>
                        <li>Correlate nhi·ªÅu ngu·ªìn log: DNS ‚Üî HTTP/TLS ‚Üî EDR ‚Üî NetFlow</li>
                        <li>Th·ª±c h√†nh IR: c√¥ l·∫≠p, ch·∫∑n, sƒÉn b√°m (hunt) & RCA</li>
                    </ol>
                </div>

                <h2>09:12 ‚Äì D·∫•u hi·ªáu ƒë·∫ßu ti√™n tr√™n dashboard</h2>
                
                <p><strong>Ng√†y 23/10/2025, 09:12 (UTC+7)</strong>, b·∫£ng ƒëi·ªÅu khi·ªÉn NDR highlight "Suspected Beaconing Pattern":</p>

                <div class="alert-details">
                    <h3>üö® Suspected Beaconing Pattern Detected</h3>
                    <div class="alert-info">
                        <div class="info-item">
                            <strong>Indicators (sample)</strong>
                            <ul>
                                <li>Host: <code>THONG-LAB-WIN02</code></li>
                                <li>DST Domain: <code>c2-edge.example.net</code></li>
                                <li>DST IP: <code>203.0.113.77</code></li>
                                <li>Protocol: HTTPS (TCP/443)</li>
                                <li>Periodicity: ~60s ¬± 10% (jitter nh·∫π)</li>
                                <li>Req size: 300‚Äì450 bytes; Resp size: 120‚Äì200 bytes</li>
                                <li>User-Agent: <code>Mozilla/5.0 (Windows NT 10.0; Win64; x64) OfficeSvc/16.0</code> (ng·ª•y trang nh∆∞ Office)</li>
                                <li>JA3 (TLS client fp): <code>771,4865-4866-4867-52393,...</code> (gi·∫£ l·∫≠p)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <p>M√¨nh nghƒ©: "Pattern n√†y gi·ªëng beacon C2: nh·ªè, ƒë·ªÅu, dai d·∫≥ng."</p>

                <h2>Triage nhanh (SOC L1)</h2>
                
                <div class="triage-section">
                    <h3>Goal: x√°c th·ª±c nghi ng·ªù, tr√°nh false positive</h3>
                    <p>M√¨nh c·∫ßn ki·ªÉm tra xem ƒë√¢y c√≥ ph·∫£i l√† app h·ª£p ph√°p c≈©ng c√≥ heartbeat hay kh√¥ng.</p>

                    <div class="triage-checklist">
                        <h3>Checklist m√¨nh s·ª≠ d·ª•ng:</h3>
                        <div class="checklist-item">
                            <input type="checkbox" id="periodicity" checked>
                            <label for="periodicity">ƒê·ªãnh k·ª≥ g·∫ßn ƒë·ªÅu (c√≥ jitter) trong ‚â• 30 ph√∫t</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="rare-dest" checked>
                            <label for="rare-dest">ƒê√≠ch hi·∫øm l·∫° (rare dest) v·ªõi endpoint n√†y</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="stable-size" checked>
                            <label for="stable-size">K√≠ch th∆∞·ªõc g√≥i t∆∞∆°ng ƒë·ªëi ·ªïn ƒë·ªãnh & nh·ªè</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="ua-ja3" checked>
                            <label for="ua-ja3">UA/JA3 kh√¥ng kh·ªõp baseline c·ªßa m√°y</label>
                        </div>
                        <div class="checklist-item">
                            <input type="checkbox" id="allowlist" checked>
                            <label for="allowlist">Kh√¥ng kh·ªõp allowlist (CDN, update server h·ª£p l·ªá)</label>
                        </div>
                    </div>

                    <div class="triage-conclusion">
                        <p>‚Üí <strong>K·∫øt lu·∫≠n L1</strong>: True Positive (nghi v·∫•n beacon) ‚áí Escalate L2.</p>
                    </div>
                </div>

                <h2>ƒêi·ªÅu tra s√¢u (SOC L2)</h2>
                
                <div class="investigation-section">
                    <h3>1) DNS ‚Üí Domain hi·∫øm + TTL "kh√≥ ch·ªãu"</h3>
                    <p><code>THONG-LAB-WIN02</code> truy v·∫•n <code>c2-edge.example.net</code> m·ªói ~60s.</p>
                    <p>TTL th·∫•p (gi·∫£ l·∫≠p 60s) ‚Üí thu·∫≠n l·ª£i cho fast-flux/jitter.</p>

                    <div class="query-section">
                        <h4>KQL ‚Äì t√¨m host n√≥i chuy·ªán v·ªõi domain hi·∫øm</h4>
                        <pre><code class="language-kql">dns.question.name: "c2-edge.example.net" 
AND host.name: "THONG-LAB-WIN02"</code></pre>
                    </div>

                    <h3>2) HTTP/TLS ‚Üí H√†nh vi "ƒë·ªÅu tay"</h3>
                    <ul>
                        <li>URI l·∫∑p: <code>/updates/checkin?id=&lt;GUID&gt;&v=1601</code></li>
                        <li>Status: 200/204; Body r·∫•t nh·ªè</li>
                        <li>JA3/JA3S kh√¥ng kh·ªõp ph·∫ßn m·ªÅm doanh nghi·ªáp ti√™u chu·∫©n</li>
                        <li>Cert: Issuer h·ª£p ph√°p (Let's Encrypt gi·∫£ l·∫≠p) nh∆∞ng SNI/CN "kh√≥ li√™n h·ªá nghi·ªáp v·ª•"</li>
                    </ul>

                    <div class="query-section">
                        <h4>Zeek-like KQL (gi·∫£ l·∫≠p mapping)</h4>
                        <pre><code class="language-kql">event.dataset: "zeek.http" 
AND destination.domain: "c2-edge.example.net"
AND http.response.status_code: (200 or 204)
AND network.bytes < 800
AND host.name: "THONG-LAB-WIN02"</code></pre>
                    </div>

                    <div class="query-section">
                        <h4>TLS/JA3</h4>
                        <pre><code class="language-kql">event.dataset: "zeek.ssl"
AND destination.ip: "203.0.113.77"
AND tls.ja3: "771,4865-4866-4867-52393,..."  // v√≠ d·ª•
AND host.name: "THONG-LAB-WIN02"</code></pre>
                    </div>

                    <h3>3) NetFlow ‚Üí Nh·ªãp ƒëi·ªáu 60s ¬± jitter</h3>
                    <div class="query-section">
                        <pre><code class="language-kql">event.dataset: "netflow"
AND source.ip: "10.10.30.21"
AND destination.ip: "203.0.113.77"</code></pre>
                    </div>
                    <p><strong>Quan s√°t</strong>: m·ªói ~60s c√≥ 1 flow ng·∫Øn, bytes ra v√†o th·∫•p & g·∫ßn c·ªë ƒë·ªãnh.</p>

                    <h3>4) EDR ‚Äì Truy v·∫øt process g·ªëc</h3>
                    <ul>
                        <li><strong>Parent</strong>: <code>C:\Users\client\AppData\Roaming\winsvchelper\winsvchelper.exe</code></li>
                        <li><strong>Child DNS/HTTP</strong>: ch√≠nh ti·∫øn tr√¨nh n√†y g·ªçi ra <code>c2-edge.example.net</code></li>
                        <li><strong>Persistence</strong>: Scheduled Task "Office Telemetry" ch·∫°y m·ªói 1 ph√∫t</li>
                    </ul>

                    <div class="query-section">
                        <h4>EDR query (pseudo)</h4>
                        <pre><code class="language-kql">process where host="THONG-LAB-WIN02" 
and (dns_request.domain="c2-edge.example.net" or netconn.dst_ip="203.0.113.77")
| project timestamp, process.name, process.parent, cmdline, sha256</code></pre>
                    </div>

                    <div class="conclusion-l2">
                        <h3>K·∫øt lu·∫≠n L2:</h3>
                        <p>Chu·ªói beaconing ‚Üí check-in h·ª£p l·ªá v·ªõi d·∫•u hi·ªáu C2. T·ªìn t·∫°i persistence (Scheduled Task). <strong>INCIDENT x√°c th·ª±c</strong>.</p>
                    </div>
                </div>

                <h2>N√¢ng c·∫•p s·ª± ki·ªán & k√≠ch ho·∫°t IR</h2>
                
                <div class="incident-escalation">
                    <ul>
                        <li><strong>Tr∆∞·ªõc</strong>: Alert ‚Äì Suspected Beaconing</li>
                        <li><strong>Sau</strong>: <strong>INCIDENT ‚Äì Active C2 Beacon (Critical)</strong></li>
                        <li><strong>Case ID</strong>: <code>INC-2025-1042</code></li>
                    </ul>
                </div>

                <div class="ir-playbook">
                    <h3>Playbook h√†nh ƒë·ªông (lab):</h3>
                    <div class="playbook-steps">
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-content">
                                <h4>Quarantine</h4>
                                <p><code>THONG-LAB-WIN02</code> (EDR/NGFW). ‚úÖ</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-content">
                                <h4>Block/Sinkhole</h4>
                                <p>domain <code>c2-edge.example.net</code>, IP <code>203.0.113.77</code>. ‚úÖ</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-content">
                                <h4>Kill & Contain</h4>
                                <p>ch·∫•m d·ª©t <code>winsvchelper.exe</code>, ch·∫∑n hash tr√™n EDR. ‚úÖ</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-content">
                                <h4>Remove persistence</h4>
                                <p>x√≥a Scheduled Task "Office Telemetry". ‚úÖ</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">5</div>
                            <div class="step-content">
                                <h4>Forensics</h4>
                                <p>thu th·∫≠p memory image, prefetch, registry run keys, shimcache, timeline MFT, Zeek/PCAP. ‚úÖ</p>
                            </div>
                        </div>
                        
                        <div class="step">
                            <div class="step-number">6</div>
                            <div class="step-content">
                                <h4>Hunt lateral</h4>
                                <p>ki·ªÉm tra SMB/WinRM/RDP, xem c√≥ t·∫£i payload hay exfil ch∆∞a. ‚úÖ</p>
                            </div>
                        </div>
                    </div>
                </div>

                <h2>Root Cause Analysis (gi·∫£ l·∫≠p)</h2>
                
                <div class="root-causes">
                    <div class="cause-item">
                        <h3>üé£ Phishing tr∆∞·ªõc ƒë√≥</h3>
                        <p>user client m·ªü file "Salary_Adjustment_2025.pdf.exe"</p>
                    </div>
                    
                    <div class="cause-item">
                        <h3>üîì EDR allow policy qu√° l·ªèng</h3>
                        <p>cho th∆∞ m·ª•c <code>%AppData%</code></p>
                    </div>
                    
                    <div class="cause-item">
                        <h3>üåê Egress ch∆∞a ch·∫∑n</h3>
                        <p>DoH/rare TLD & thi·∫øu DNS RPZ/Threat Intel</p>
                    </div>
                    
                    <div class="cause-item">
                        <h3>üîç Kh√¥ng c√≥ TLS fingerprinting</h3>
                        <p>baseline ‚Üí kh√≥ spot JA3 l·∫°</p>
                    </div>
                </div>

                <div class="mitre-attack">
                    <h3>MITRE ATT&CK (tham chi·∫øu):</h3>
                    <ul>
                        <li><strong>TA0011</strong> Command and Control</li>
                        <li><strong>T1071.001</strong> Web Protocols (HTTPS)</li>
                        <li><strong>T1568</strong> Dynamic Resolution (DNS)</li>
                        <li><strong>T1105</strong> Ingress Tool Transfer (n·∫øu c√≥ t·∫£i th√™m)</li>
                        <li><strong>TA0003</strong> Persistence: <strong>T1053.005</strong> (Scheduled Task)</li>
                    </ul>
                </div>

                <h2>Email t√≥m t·∫Øt g·ª≠i l√£nh ƒë·∫°o (gi·∫£ l·∫≠p)</h2>
                
                <div class="email-template">
                    <div class="email-header">
                        <strong>Subject</strong>: [Executive Summary] Active C2 Beacon on Windows Client ‚Äî <strong>Critical</strong>
                    </div>
                    
                    <div class="email-body">
                        <p>K√≠nh g·ª≠i th·∫ßy/c√¥ & mentor,</p>
                        
                        <p>S√°ng <strong>23/10/2025 (UTC+7)</strong>, SOC lab x√°c ƒë·ªãnh C2 beacon t·ª´ <code>THONG-LAB-WIN02</code> t·ªõi <code>c2-edge.example.net</code> (<code>203.0.113.77</code>) qua HTTPS theo chu k·ª≥ ~60s ¬± jitter. EDR ghi nh·∫≠n ti·∫øn tr√¨nh <code>winsvchelper.exe</code> (kh√¥ng h·ª£p l·ªá) c√πng Scheduled Task gi·∫£ m·∫°o "Office Telemetry".</p>
                        
                        <h4>ƒê√£ x·ª≠ l√Ω:</h4>
                        <p>C√¥ l·∫≠p m√°y, block domain/IP, ti√™u di·ªát ti·∫øn tr√¨nh, g·ª° persistence, thu th·∫≠p forensics, sƒÉn b√°m lateral.</p>
                        
                        <h4>M·ª©c ƒë·ªô:</h4>
                        <p><strong>Critical</strong> (k√™nh C2 ch·ªß ƒë·ªông).</p>
                        
                        <h4>Nguy√™n nh√¢n s∆° b·ªô:</h4>
                        <p>Kh·∫£ nƒÉng do phishing + egress/DNS control y·∫øu.</p>
                        
                        <p>ƒê·ªÅ xu·∫•t h·ªçp <strong>Post-Incident Review l√∫c 14:00, 23/10/2025</strong> ƒë·ªÉ ch·ªët kh·∫Øc ph·ª•c d√†i h·∫°n.</p>
                        
                        <p>Tr√¢n tr·ªçng,<br>
                        <strong>Th√¥ng</strong> ‚Äì SOC Lab (Sinh vi√™n nƒÉm 3)</p>
                    </div>
                </div>

                <h2>B·∫£ng quy·∫øt ƒë·ªãnh triage (m·∫´u)</h2>
                
                <div class="triage-table">
                    <table>
                        <thead>
                            <tr>
                                <th>M·ª•c ki·ªÉm tra</th>
                                <th>M√¥ t·∫£</th>
                                <th>K·∫øt qu·∫£</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Periodicity</td>
                                <td>Chu k·ª≥ ~60s ¬± 10% ‚â• 30 ph√∫t</td>
                                <td>‚úÖ</td>
                            </tr>
                            <tr>
                                <td>Rare dest</td>
                                <td>Domain/IP hi·∫øm v·ªõi endpoint</td>
                                <td>‚úÖ</td>
                            </tr>
                            <tr>
                                <td>K√≠ch th∆∞·ªõc ·ªïn ƒë·ªãnh</td>
                                <td>Request/Response nh·ªè v√† ƒë·ªÅu</td>
                                <td>‚úÖ</td>
                            </tr>
                            <tr>
                                <td>UA/JA3 l·∫°</td>
                                <td>Kh√¥ng thu·ªôc baseline ph·∫ßn m·ªÅm doanh nghi·ªáp</td>
                                <td>‚úÖ</td>
                            </tr>
                            <tr>
                                <td>TI/Allowlist</td>
                                <td>Kh√¥ng thu·ªôc allowlist; TI kh√¥ng legit</td>
                                <td>‚úÖ</td>
                            </tr>
                            <tr class="decision-row">
                                <td><strong>Quy·∫øt ƒë·ªãnh</strong></td>
                                <td><strong>True Positive ‚Äì Beacon</strong></td>
                                <td><strong>ESCALATE</strong></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h2>Khuy·∫øn ngh·ªã ph√≤ng th·ªß (√°p d·ª•ng ngay trong lab)</h2>
                
                <div class="hardening-recommendations">
                    <div class="recommendation-category">
                        <h3>üîí DNS Security</h3>
                        <ul>
                            <li>RPZ/sinkhole, block DoH l·∫°, monitor NXDomain burst/DGA</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-category">
                        <h3>üåê Egress Policy</h3>
                        <ul>
                            <li>ch·∫∑n ra Internet theo allowlist (proxy), TLS SNI/JA3 ki·ªÉm so√°t</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-category">
                        <h3>üõ°Ô∏è EDR Hardening</h3>
                        <ul>
                            <li>ch·∫∑n process hollowing/LOLbins, b·∫£o v·ªá %AppData%, block hash</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-category">
                        <h3>üìß Email Security</h3>
                        <ul>
                            <li>sandbox file ƒë√≠nh k√®m, c·∫£nh b√°o double extension</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-category">
                        <h3>üìä Baselining</h3>
                        <ul>
                            <li>l·∫≠p UA/JA3 baseline theo asset group</li>
                        </ul>
                    </div>
                    
                    <div class="recommendation-category">
                        <h3>üîç Detections</h3>
                        <ul>
                            <li>rule cho periodicity + low-bytes + rare dest; correlation DNS‚ÜîTLS‚ÜîHTTP</li>
                        </ul>
                    </div>
                </div>

                <h2>Truy v·∫•n m·∫´u m√¨nh d√πng (tham kh·∫£o)</h2>
                
                <div class="useful-queries">
                    <h3>KQL ‚Äì ph√°t hi·ªán chu k·ª≥ th√¥ (bin time)</h3>
                    <pre><code class="language-kql">event.dataset: "proxy" AND host.name: "THONG-LAB-WIN02" 
AND destination.domain: "c2-edge.example.net"
| stats count() by date_histogram(field: "@timestamp", fixed_interval: "1m")</code></pre>
                    
                    <h3>KQL ‚Äì l·ªçc beacon nh·ªè & ƒë·ªÅu qua HTTPS</h3>
                    <pre><code class="language-kql">event.dataset: "zeek.http" AND destination.domain: "c2-edge.example.net" 
AND http.response.status_code: (200 or 204)
AND bytes <= 800 AND user_agent.original: "Mozilla*OfficeSvc*"
AND host.name: "THONG-LAB-WIN02"</code></pre>
                    
                    <h3>Splunk SPL ‚Äì ƒëo "nh·ªãp" 60s</h3>
                    <pre><code class="language-splunk">index=proxy host=THONG-LAB-WIN02 dest_domain="c2-edge.example.net"
| bin _time span=60s
| stats count avg(bytes_out) avg(bytes_in) by _time
| eventstats stdev(count) as std p95(count) as p95
| where count>=1</code></pre>
                    
                    <h3>Sigma (√Ω t∆∞·ªüng, r√∫t g·ªçn)</h3>
                    <pre><code class="language-yaml">title: Possible C2 Beacon via Low-Size Periodic HTTPS
logsource: category: proxy
detection:
  sel:
    cs-host: "c2-edge.example.net"
    sc-status|contains: ["200","204"]
    bytes|lt: 800
  condition: sel
level: high</code></pre>
                </div>

                <div class="tip-box">
                    <h3>üí° M·∫πo quan tr·ªçng:</h3>
                    <p>Tr√°nh ph·ª• thu·ªôc 1 d·∫•u hi·ªáu. K·∫øt h·ª£p: <strong>periodicity + rare dest + low-bytes + UA/JA3 b·∫•t th∆∞·ªùng + kh√¥ng thu·ªôc allowlist</strong>.</p>
                </div>

                <h2>B√†i h·ªçc m√¨nh r√∫t ra</h2>
                
                <div class="lesson-learned">
                    <blockquote>
                        <p>"Beacon kh√¥ng ·ªìn, nh∆∞ng ƒë·ªÅu. Ch√¨a kh√≥a l√† baseline v√† correlation ƒëa ngu·ªìn. N·∫øu kh√¥ng ki·ªÉm so√°t egress/DNS, k·∫ª t·∫•n c√¥ng (attacker) s·∫Ω lu√¥n t√¨m th·∫•y ƒë∆∞·ªùng th√¨ th·∫ßm ra ngo√†i."</p>
                    </blockquote>
                </div>

                <h2>K·∫øt lu·∫≠n</h2>
                
                <p>Qua b√†i t·∫≠p n√†y, m√¨nh ƒë√£ h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu ƒëi·ªÅu v·ªÅ vi·ªác ph√°t hi·ªán v√† x·ª≠ l√Ω C2 beacon. ƒêi·ªÅu quan tr·ªçng nh·∫•t m√¨nh nh·∫≠n ra l√†: <strong>Beacon detection kh√¥ng ch·ªâ d·ª±a v√†o m·ªôt d·∫•u hi·ªáu duy nh·∫•t, m√† c·∫ßn k·∫øt h·ª£p nhi·ªÅu ngu·ªìn d·ªØ li·ªáu kh√°c nhau</strong>.</p>
                
                <p>Vi·ªác thi·∫øt l·∫≠p baseline v√† correlation ƒëa ngu·ªìn l√† ch√¨a kh√≥a ƒë·ªÉ ph√°t hi·ªán nh·ªØng ho·∫°t ƒë·ªông √¢m th·∫ßm nh∆∞ C2 beacon. M√¨nh c≈©ng hi·ªÉu r√µ h∆°n v·ªÅ t·∫ßm quan tr·ªçng c·ªßa vi·ªác ki·ªÉm so√°t egress traffic v√† DNS security.</p>
                
                <p>M√¨nh hy v·ªçng b√†i vi·∫øt n√†y s·∫Ω gi√∫p c√°c b·∫°n c√≥ c√°i nh√¨n th·ª±c t·∫ø v·ªÅ c√¥ng vi·ªác Threat Hunting v√† C2 Detection. N·∫øu c√°c b·∫°n c√≥ c√¢u h·ªèi ho·∫∑c mu·ªën chia s·∫ª kinh nghi·ªám, h√£y li√™n h·ªá v·ªõi m√¨nh nh√©!</p>

                <div class="post-footer">
                    <div class="post-share">
                        <h4>Chia s·∫ª b√†i vi·∫øt:</h4>
                        <div class="share-buttons">
                            <a href="#" class="share-btn facebook"><i class="fab fa-facebook"></i></a>
                            <a href="#" class="share-btn twitter"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="share-btn linkedin"><i class="fab fa-linkedin"></i></a>
                            <a href="#" class="share-btn copy"><i class="fas fa-copy"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </article>

    <!-- Related Posts -->
    <section class="related-posts">
        <div class="container">
            <h3>B√†i vi·∫øt li√™n quan</h3>
            <div class="related-posts-grid">
                <article class="related-post">
                    <div class="related-post-image">
                        <img src="https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=300&h=200&fit=crop" alt="Incident Response">
                    </div>
                    <div class="related-post-content">
                        <h4><a href="incident-response.html">üîπ Blue Team: L√†m g√¨ khi b·ªã t·∫•n c√¥ng?</a></h4>
                        <p>Quy tr√¨nh Incident Response (IR) c∆° b·∫£n cho ng∆∞·ªùi m·ªõi ‚Äì 6 b∆∞·ªõc v√†ng...</p>
                    </div>
                </article>
                <article class="related-post">
                    <div class="related-post-image">
                        <img src="https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=300&h=200&fit=crop" alt="SOC Introduction">
                    </div>
                    <div class="related-post-content">
                        <h4><a href="soc-introduction.html">üõ°Ô∏è SOC l√† g√¨? Gi·ªõi thi·ªáu ƒë∆°n gi·∫£n v·ªÅ Security Operations Center</a></h4>
                        <p>H∆∞·ªõng d·∫´n c∆° b·∫£n v·ªÅ trung t√¢m tr·ª±c an ninh m·∫°ng cho ng∆∞·ªùi m·ªõi b·∫Øt ƒë·∫ßu...</p>
                    </div>
                </article>
            </div>
        </div>
    </section>

    <!-- Footer Placeholder -->
    <div id="footer-placeholder"></div>

    <!-- Audio Player -->
    <div class="audio-player" id="audio-player">
        <div class="audio-controls">
            <button class="audio-toggle" id="audio-toggle">
                <i class="fas fa-play" id="play-icon"></i>
            </button>
            <div class="audio-info">
                <span class="song-title">MUSIC</span>
                <span class="song-artist">PIANO</span>
            </div>
            <div class="audio-volume">
                <i class="fas fa-volume-up"></i>
                <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="50">
            </div>
        </div>
        <audio id="background-music" loop>
            <source src="../../assets/Music/Beethoven1.mp3" type="audio/mpeg">
            <source src="https://www.bensound.com/bensound-music/bensound-sunny.mp3" type="audio/mpeg">
        </audio>
    </div>

    <!-- Load Components Script -->
    <script src="../../assets/js/load-components.js"></script>
    <!-- Custom JavaScript -->
    <script src="../../assets/js/script.js"></script>
    <script src="../../assets/js/blog.js"></script>
    <script src="../../assets/js/global-audio.js"></script>
    <script src="../../assets/js/audio-player.js"></script>
    <script src="../../assets/js/animations.js"></script>
    <!-- New Features -->
    <script src="../../assets/js/dark-mode.js"></script>
    <script src="../../assets/js/i18n.js"></script>
    <script src="../../assets/js/comments.js"></script>
    <script src="../../assets/js/related-posts.js"></script>
    <script src="../../assets/js/blog-animations.js"></script>
    <script src="../../assets/js/performance-optimizer.js"></script>
    <!-- Prism.js for code highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
